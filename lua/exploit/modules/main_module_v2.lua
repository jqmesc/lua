if getgenv().main_module then
    main_module.MainFrame:Destroy()
	warn('[Main Module]: old module removed')
end;

getgenv().main_module = { }

main_module.MainFrame = Instance.new('Folder', game.CoreGui)
main_module.MainFrame.Name = 'Main_Module'

main_module.Functions = { };
main_module.Library = { };
main_module.Console = { };
main_module.Admin = { };
main_module.Message = { };
main_module.Keybind = { };
main_module.Aimbot = { };
main_module.Esp = { };


local plr = game.Players.LocalPlayer
local uis = game:GetService('UserInputService')

local Y_CONSTANT = 22

-- // Function Library // --
main_module.Functions.RayHit = function(v1, v2, v3, v4)
	local vector = (v2.Position - v1.Position).Unit
	local ray = Ray.new(v1.Position, vector * (v4 or 9e9)*-1)
	local hit = game.Workspace:FindPartOnRayWithIgnoreList(ray, v3)
	
	return hit
end;

local current_loops = { }
function main_module.Functions:RunLoop(v1, v2)
    current_loops[v1] = true
    spawn(function()
        repeat v2() game:GetService('RunService').RenderStepped:wait() until current_loops[v1] == false
    end);
end;
function main_module.Functions:EndLoop(v1)
    current_loops[v1] = false
end;
function main_module.Functions:CopyTable(v1)
    local _new = { };
	for i,v in pairs(v1) do
		_new[i]=v;
	end
	return _new;
end
function main_module.Functions:FindTable(v1, v2, v3)
	if type(v1) == 'table' then
		local _return;
		local function getValue()
			return _return
		end
		-- local function setValue(v1)
		-- 	_return = v1
		-- 	print('value set')
		-- end
		local setValue;
		for i,v in pairs(v1) do
			if (v == v2 or tostring(v) == tostring(v2)) or (i == v2 or tostring(i) == tostring(v2)) then
				_return = v;
				setValue = function(v4)
					_return = v4;
					v1[i] = v4;
				end
			end
			if type(v) == 'table' and v3 then
				local _getValue, _setValue = main_module.Functions:FindTable(v, v2, v3);
				if _getValue() then 
					_return = _getValue();
					getValue = _getValue;
					setValue = _setValue;
				end
			end
		end
		return getValue, setValue;
	end
end
function main_module.Functions:FindFirstDescendant(instance, name) -- thx doge
    for i,v in pairs(instance:GetDescendants()) do
		if v == name or tostring(v) == tostring(name) then
			return v;
		end
	end
end
function main_module.Functions:WaitForDescendant(instance, name) -- thx doge
    local descendant = instance:FindFirstChild(name, true)
    if not descendant then
        repeat
            descendant = instance.DescendantAdded:wait()
        until descendant.Name == name
    end
    return descendant
end

-- // UI Library // --
local library = main_module.Library
library.gui = Instance.new('ScreenGui', main_module.MainFrame)
library.gui.Name = 'UI_Lib'

local MainFrame = Instance.new('Frame', library.gui)
MainFrame.AnchorPoint = Vector2.new(0.5, 0)
MainFrame.BackgroundTransparency = 1
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.5, 0, 0.025, 0)
MainFrame.Size = UDim2.new(0.95, 0, 0.275, 0)

local listLayout = Instance.new('UIListLayout', MainFrame)
listLayout.FillDirection = Enum.FillDirection.Horizontal
listLayout.SortOrder = Enum.SortOrder.LayoutOrder
listLayout.Padding = UDim.new(0.01, 0)

function library:AddFrame(settings) -- ADD SUB HEADERS
    --[[


    settings = {
        name = 'Title';
    }


    --]]
    local Frame = Instance.new('Frame', MainFrame)
    Frame.BackgroundColor3 = Color3.fromRGB(115, 80, 146)
    Frame.Size = UDim2.fromOffset(265, 0)
    Frame.BorderSizePixel = 0
    Frame.ChildAdded:Connect(function()
        Frame.Size = UDim2.new(0, 265, 0, (#Frame:GetChildren()-1)*Y_CONSTANT)
    end);
    Frame.ChildRemoved:Connect(function()
        Frame.Size = UDim2.new(0, 265, 0, (#Frame:GetChildren()-1)*Y_CONSTANT)
    end);
    
    local UIListLayout = Instance.new('UIListLayout', Frame)
    UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder

    local title = Instance.new('TextLabel', Frame)
    title.BackgroundTransparency = 1
    title.Size = UDim2.new(1, 0, 0, Y_CONSTANT)
    title.Font = Enum.Font.SourceSansBold
    title.Text = settings and settings['name'] or 'Title';
    title.TextScaled = true
    title.TextColor3 = Color3.fromRGB(140, 140, 140)
    title.TextXAlignment = Enum.TextXAlignment.Center
    
    title.LayoutOrder = -1

    local Self = { }

	function Self:Add(txt, clr)
        local label = Instance.new('TextLabel', Frame)
        label.TextColor3 = clr or Color3.fromRGB(140, 140, 140)
        label.Text = txt
        label.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        label.BackgroundTransparency = 1
        label.Size = UDim2.new(1, 0, 0, Y_CONSTANT)
        label.Font = Enum.Font.SourceSansBold --Enum.Font.SourceSansItalic
        label.TextXAlignment = 'Center'
        label.TextSize = 18
		
        local frame = Instance.new('Frame', label)
		frame.BorderSizePixel = 0;
		frame.BackgroundColor3 = Color3.fromRGB(140, 140, 140);
		frame.Size = UDim2.new(.5, 0, 0.1, 0);
		frame.Position = UDim2.new(.25, 0, .85, 0)
	end

    function Self:AddButton(txt, _function)
		local _functions = { };
		local _lock = false;
        local button = Instance.new('TextButton', Frame)
        button.TextColor3 = Color3.new(1,1,1)
        button.Text = ' '..txt
        button.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        button.BackgroundTransparency = 1
        button.Size = UDim2.new(1, 0, 0, Y_CONSTANT)
        button.Font = Enum.Font.SourceSansItalic
        button.TextXAlignment = 'Left'
        button.TextSize = 14

		local _l = Instance.new('Frame', button);
		_l.Size = UDim2.new(1, 0, 1, 0);
		_l.BorderSizePixel = 0;
		_l.BackgroundColor3 = Color3.fromRGB(70, 70, 70);
		_l.BackgroundTransparency = 0.5;
		_l.Visible = false;

        button.MouseButton1Click:Connect(function()
			if _lock then return end;
            _function()
        end);
		function _functions:Fire()
			_function();
		end
		function _functions:Lock(v1)
			if v1 == nil then
				_lock = true;
				_l.Visible = true;
				return;
			end
			_lock = v1;
			_l.Visible = v1;
		end

        return _functions;
    end;
    function Self:AddToggle(txt, _function)
		local _functions = { };
		local _lock = false;
        local state = false

        local button = Instance.new('TextButton', Frame)
        button.TextColor3 = Color3.new(1,1,1)
        button.Text = ' '..txt
        button.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        button.BackgroundTransparency = 1
        button.Size = UDim2.new(1, 0, 0, Y_CONSTANT)
        button.Font = Enum.Font.SourceSansItalic
        button.TextXAlignment = 'Left'
        button.TextSize = 14

        local toggle = Instance.new('TextLabel', button)
        toggle.Size = UDim2.new(1, 0, 1, 0)
        toggle.Text = 'Off '
        toggle.TextColor3 = Color3.fromRGB(255, 0, 0)
        toggle.TextXAlignment = 'Right'
        toggle.BackgroundTransparency = 1
        toggle.Font = 'SourceSansBold'
        toggle.TextSize = 14

		local _l = Instance.new('Frame', button);
		_l.Size = UDim2.new(1, 0, 1, 0);
		_l.BorderSizePixel = 0;
		_l.BackgroundColor3 = Color3.fromRGB(70, 70, 70);
		_l.BackgroundTransparency = 0.5;
		_l.Visible = false;
		
        button.MouseButton1Click:Connect(function()
			if _lock then return end;
            _functions:SetState(not state);
        end);
		function _functions:SetState(v1)
			state = v1;
            
            toggle.Text = state and 'On ' or 'Off ';
            toggle.TextColor3 = state and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0);

            _function(state);
		end
		function _functions:GetState()
			return state;
		end
		function _functions:Toggle()
			if not _lock then
				self:SetState(not self:GetState())
			end
		end
		function _functions:Lock(v1)
			if v1 == nil then
				_lock = true;
				_l.Visible = true;
				return;
			end
			_lock = v1;
			_l.Visible = v1;
		end

        return _functions;
    end;
    function Self:AddBox(txt, _function)
		local _functions = { };
		local _lock = false;
        local value = ''

        local textbox = Instance.new('TextBox', Frame)
        textbox.PlaceholderText = ' '..txt
		textbox.Text = ''
		textbox.BackgroundTransparency = 0.9
		textbox.BackgroundColor3 = Color3.fromRGB(0,0,0)
		textbox.TextColor3 = Color3.new(1,1,1)
		textbox.TextXAlignment = 'Left'
        textbox.Size = UDim2.new(1, 0, 0, Y_CONSTANT)
		textbox.BorderSizePixel = 0
		textbox.Font = 'SourceSansItalic'
		textbox.TextSize = 14

		local _l = Instance.new('Frame', textbox);
		_l.Size = UDim2.new(1, 0, 1, 0);
		_l.BorderSizePixel = 0;
		_l.BackgroundColor3 = Color3.fromRGB(70, 70, 70);
		_l.BackgroundTransparency = 0.5;
		_l.Visible = false;
        
        local placeholder_old = textbox.PlaceholderText

        textbox.FocusLost:Connect(function()
			if _lock then textbox.PlaceholderText = placeholder_old..' ('..value..')'; textbox.Text = ''; return end;
            _functions:SetValue(textbox.Text)
        end);

		function _functions:SetValue(v1)
			value = v1;
            _function(value);
            textbox.PlaceholderText = placeholder_old..' ('..value..')';
            textbox.Text = '';
		end
		function _functions:GetValue()
			return value;
		end
		function _functions:Lock(v1)
			if v1 == nil then
				_lock = true;
				_l.Visible = true;
				return;
			end
			_lock = v1;
			_l.Visible = v1;
		end
        
        return _functions;
    end;
    function Self:AddSwitch(txt, list, _function)
		local _functions = { };
		local _lock = false;
        local _index = 1;

        local button = Instance.new('TextButton', Frame)
        button.TextColor3 = Color3.new(1,1,1)
        button.Text = ' '..txt
        button.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        button.BackgroundTransparency = 1
        button.Size = UDim2.new(1, 0, 0, Y_CONSTANT)
        button.Font = Enum.Font.SourceSansItalic
        button.TextXAlignment = 'Left'
        button.TextSize = 14

        local switcher = Instance.new('TextLabel', button)
        switcher.Size = UDim2.new(1, 0, 1, 0)
        switcher.Text = list[1]..' '
        switcher.TextColor3 = Color3.fromRGB(140, 140, 140)
        switcher.TextXAlignment = 'Right'
        switcher.BackgroundTransparency = 1
        switcher.Font = 'SourceSansBold'
        switcher.TextSize = 14

		local _l = Instance.new('Frame', button);
		_l.Size = UDim2.new(1, 0, 1, 0);
		_l.BorderSizePixel = 0;
		_l.BackgroundColor3 = Color3.fromRGB(70, 70, 70);
		_l.BackgroundTransparency = 0.5;
		_l.Visible = false;

        button.MouseButton1Click:Connect(function()
			if _lock then return end;
			_functions:SetIndex(_index + 1)
        end);
        
		function _functions:SetIndex(v1)
			_index = v1;
			if _index > #list then
				_index = 1;
			end
			switcher.Text = tostring(list[_index])..' '
            _function(list[_index])
			return _index;
		end
		function _functions:GetIndex()
			return _index;
		end
		function _functions:Lock(v1)
			if v1 == nil then
				_lock = true;
				_l.Visible = true;
				return;
			end
			_lock = v1;
			_l.Visible = v1;
		end

        return _functions;
    end;

    return Self
end;
function library:Toggle(x)
    MainFrame.Visible = x or not MainFrame.Visible
    return MainFrame.Visible;
end;

-- // Console // -- (please remake this Sinsane)
local Console = main_module.Console
Console.gui = Instance.new('ScreenGui', main_module.MainFrame)
Console.gui.Name = 'Console'

Console.commands = { }

function Console:Create(settings)
    --[[
        

    settings = {
        name = 'Title';
        capturekey = Enum.KeyCode.RightShift;
    }


    --]]

	local name = settings['name'] or 'Console'
	local capturekey = settings['capturekey'] or Enum.KeyCode.F1

    local ConsoleFrame = Instance.new('Frame', Console.gui)
    ConsoleFrame.BackgroundColor3 = Color3.fromRGB(115, 80, 146)
    ConsoleFrame.BorderSizePixel = 0
    ConsoleFrame.Size = UDim2.new(1, 0, 0.3, 0)

	-- ADD TITLE
	local title = Instance.new('TextLabel', ConsoleFrame)
	title.TextColor3 = Color3.fromRGB(120, 120, 120)
	title.TextSize = 40
	title.Font = 'SourceSansBold'
	title.Size = UDim2.new(1, 0, 0.2, 0)
	title.BackgroundTransparency = 1
	title.Text = settings['name'] or 'Console'

	local holder = Instance.new('Frame', ConsoleFrame)
	holder.BackgroundTransparency = 1
	holder.Size = UDim2.new(1, 0, 0.9, 0)

	local box = Instance.new('TextBox', ConsoleFrame)
	box.PlaceholderText = ''
	box.Text = ''
	box.BackgroundTransparency = 0.9
	box.BackgroundColor3 = Color3.fromRGB(0,0,0)
	box.TextColor3 = Color3.new(1,1,1)
	box.TextXAlignment = 'Left'
	box.Size = UDim2.new(1, 0, 0.1, 0)
	box.Position = UDim2.new(0, 0, 0.9, 0)
	box.BorderSizePixel = 0
	box.Font = 'SourceSansItalic'
	box.TextSize = 14

	local example = Instance.new('TextLabel', ConsoleFrame)
	example.Position = UDim2.new(0, 0, 0.925, 0)
	example.Size = UDim2.new(1, 0, 0.075, 0)
	example.Text = ''
	example.TextColor3 = Color3.new(1,1,1)
	example.TextXAlignment = 'Left'
	example.BackgroundTransparency = 1
	example.Font = 'SourceSansItalic'
	example.TextSize = 16
    example.Visible = false


	local newOutput = function(msg, clr)
		for i,v in pairs(holder:GetChildren()) do
			if v.Position.Y.Scale > 0 then
				v.Position = UDim2.new(0, 0, v.Position.Y.Scale - .075, 0)
			else
				v:Destroy()
			end;
		end;
		local newmsg = example:Clone()
		newmsg.Text = '[Console] '..msg
		newmsg.Parent = holder
		newmsg.Visible = true
		if clr then
			newmsg.TextColor3 = clr
		else
			newmsg.TextColor3 = Color3.fromRGB(255, 255, 255)
		end;
	end;

	uis.InputBegan:connect(function(key, gpi)
		if key.KeyCode == capturekey then
			if ConsoleFrame.Visible == true then
				ConsoleFrame.Visible = false
				box:ReleaseFocus()
				box.Text = ''
			else
				ConsoleFrame.Visible = true
				wait()
				box:CaptureFocus()
			end;
		end;
	end);


	box.FocusLost:connect(function(_)
		if ConsoleFrame.Visible then
			local input = box.Text
            local rawinput = input:lower()
			local inputsep = rawinput:split(' ')

			local _index
			local foundFunc
			for i,v in pairs(Console.commands) do
				_index = ''
				for i2,v2 in pairs(inputsep) do
					_index = _index..inputsep[i2]
					if _index == i then -- got function
						foundFunc = true
						spawn(function()
							local _newInput = table.concat(inputsep, ' ', i2+1)

						 	v3, v4 = v(_newInput)

							if v3 then
								newOutput(v3, v4 or Color3.fromRGB(255,255,255))
							end
						end)
					end
					_index = _index..' '
				end
			end

            if _ and not foundFunc then
				newOutput(input)
			end

			wait()
			box:CaptureFocus()
		end;
	end);


    Self = { }
    function Self:AddCommand(cmd, _function)
        Console.commands[cmd:lower()] = _function
    end;
    function Self:Output(...)
        newOutput(...)
    end;
    function Self:Clear()
        holder:ClearAllChildren()
    end;
	function Self:GetCommandList()
		local _commands = { }
		for i,v in pairs(Console.commands) do
			table.insert(_commands, i)
		end
		return _commands
	end;	

	box:CaptureFocus()
    return Self
end;

-- // Esp // -- NEW!!!
local esp = main_module.Esp
esp.gui = Instance.new('ScreenGui', main_module.MainFrame)
esp.gui.Name = 'Esp'

function esp.new(settings)
	local folder = settings['folder']
	local color = settings['color'] or Color3.fromRGB(255, 255, 255)
	local transparency = settings['transparency'] or 0.5
	local distance = settings['distance'] or false

	local newFolder = Instance.new('Folder', esp.gui)

	local function makeESP(v1,v2,v3)
		local _primarypart = (v1:FindFirstChild('HumanoidRootPart')) or (v1:IsA('Model') and v1.PrimaryPart) or (v1:IsA('BasePart') and v1) or false
		
		local box = Instance.new('Highlight', newFolder)
		box.Adornee = v1
		box.Name = v1.Name
		box.FillTransparency = 1
		box.OutlineTransparency = v3 
		box.OutlineColor = v2
		
		local bg = Instance.new('BillboardGui', box)
		bg.Adornee = v1
		bg.LightInfluence = 0
		bg.AlwaysOnTop = true
		bg.Enabled = distance
		bg.Size = UDim2.new(4, 0,1, 0)
		bg.StudsOffset = Vector3.new(0,4,0)
		
		local dist = Instance.new('TextLabel', bg)
		dist.BackgroundTransparency = 1
		dist.TextColor3 = Color3.fromRGB(115, 80, 146)
		dist.TextSize = 20
		dist.Font = 'SourceSansBold'
		dist.Size = UDim2.new(1,0,1,0)
		dist.ZIndex = -1

		spawn(function()
			repeat game:GetService('RunService').RenderStepped:wait()
				local _char = game.Players.LocalPlayer.Character
				if _char and _primarypart then
					local _distance = (_primarypart.Position - _char:WaitForChild('HumanoidRootPart').Position).magnitude;
					bg.Enabled = distance;
					dist.Text = 'Dist: ' .. math.round( _distance )
				else
					bg.Enabled = false;
				end
			until not box or not box.Parent;
		end)

		spawn(function() -- object removed
			--repeat wait() until table.find(folder, v1)
			--repeat wait() until not v1 or not table.find(folder, v1)
			repeat wait() until not v1.Parent
			for i,v in pairs(newFolder:GetChildren()) do
				if v.Adornee == index or not v.Adornee.Parent then
					--print('ADORNEE')
					v:Destroy()
				end
			end
			--print('obj removed')
		end)
	end

	local _folder = folder or parent:GetChildren()
	for i,v in pairs(_folder) do
		makeESP(v, color, transparency)
	end

	if folder then
		setmetatable(folder, {
			__newindex = function(_, index, value)
				--print(tostring(index) .. " has been added and set to " .. tostring(value))
				if value then
					for i,v in pairs(newFolder:GetChildren()) do
						if v.Adornee == index or not v.Adornee.Parent then
							--print('ADORNEE2')
							v:Destroy()
						end
					end
					makeESP(value, color, transparency)-- remove (compare highlight adornee to index?)
				end
			end
		})
	end
	if parent then
		parent.ChildAdded:connect(function(c)
			wait(0.05)
			makeESP(c, color, transparency)
		end)
	end

	local Self = { }

	function Self:SetColor(v1)
		for i,v in pairs(newFolder:GetChildren()) do
			v.OutlineColor = v1
		end
	end
	function Self:SetTransparency(v1)
		for i,v in pairs(newFolder:GetChildren()) do
			v.OutlineTransparency = tonumber(v1) or 0.75
		end
	end
	function Self:Remove()
		newFolder:Destroy()
	end

	return Self

end

-- // Aimbot // --
local Aimbot = main_module.Aimbot
function Aimbot.new(settings) -- add auto shoot
    --[[ 
	settings = {
		folder = game.Workspace;
		target = 'Head';
		key = 'z';
		initial = false;
		smoothness = 1;
		visible = true;
		distance = 100;
		health = Health;
		team = false;
	} 
	--]]

	local folder = settings['folder'] or game.Workspace:GetChildren()
	local target = settings['target'] or 'Head'
	local initial = settings['initial'] or true
	local smoothness = settings['smoothness'] or 1
	local visible = settings['visible'] or false
	local distance = settings['distance'] or 9e9
	local team = settings['team'] or false
	local spin = settings['spin'] or false;
	local key = settings['key']

	local removeaimbot = false
	local doaimbot = initial

	function getAimPartFromClosestPlayer()
		local closest,curDist = nil, Vector2.new(math.huge, math.huge).magnitude
		local folder = (type(folder) == 'table' and folder) or folder:GetChildren();
		for i,v in pairs(folder) do
			local target = v:FindFirstChild(target, true) or (v:IsA('BasePart') and v);
			if v.Name ~= plr.Name and target then
				local passedChecks = true
				if v:FindFirstChildOfClass('Humanoid') and v:FindFirstChildOfClass('Humanoid').Health <= 0 then
					passedChecks = false
				end
				if visible then
					-- local vector = (game.Players.LocalPlayer.Character.Head.Position - v:FindFirstChild(settings['target'] or 'Head').Position).Unit
					-- local ray = Ray.new(game.Players.LocalPlayer.Character.Head.Position, vector * (settings['distance'] or 9e9)*-1)
					-- local hit = game.Workspace:FindPartOnRayWithIgnoreList(ray, {game.Players.LocalPlayer.Character.Head, game.Players.LocalPlayer.Character:FindFirstChild(settings['target'] or 'Head', true)})
					local ignore_list = { game.Players.LocalPlayer.Character.Head, game.Players.LocalPlayer.Character:FindFirstChild(target, true) }
					for i = 1, 5 do
						local hit = RayHit(target, ignore_list, distance)
						if hit and not hit:IsDescendantOf(v) and hit.CanCollide == true and hit.Transparency ~= 1 then
							passedChecks = false
							print('[AIMBOT] - DID NOT PASS CHECK (visible)')
						else
							table.insert(ignore_list, hit)
						end;
					end;
				end;
				if team then
					if game.Players:FindFirstChild(v.Name) and game.Players:FindFirstChild(v.Name).Team == game.Players.LocalPlayer.Team then
						passedChecks = false
						print('[AIMBOT] - DID NOT PASS CHECK (team)')
					end;
				end;
				if passedChecks then
					local z = game.Workspace.CurrentCamera:WorldToViewportPoint(target.Position)
					local mouse = game:GetService('UserInputService'):GetMouseLocation()
					local dist = Vector2.new((z.X - mouse.X), (z.Y - mouse.Y)).magnitude

					if curDist > dist then
						curDist = dist
						closest = target
					end;
				end;
			end;
		end;
		return closest,curDist
	end;
	function Aim()
		local part,distance = getAimPartFromClosestPlayer()
		local v, isonscreen = game.Workspace.CurrentCamera:WorldToViewportPoint(part.Position)
		local mouse = game:GetService('UserInputService'):GetMouseLocation()
		if isonscreen and doaimbot and not removeaimbot then
			if rawget(settings, 'key') then
				if game:GetService('UserInputService'):IsKeyDown(key) then
					mousemoverel((v.X/smoothness - mouse.X/smoothness), (v.Y/smoothness) - mouse.Y/smoothness)
				end;
			else
				if game:GetService('UserInputService'):IsMouseButtonPressed(Enum.UserInputType.MouseButton2) then
					mousemoverel((v.X/smoothness - mouse.X/smoothness), (v.Y/smoothness - mouse.Y/smoothness))
				end;
			end;
		else	
			if not isonscreen and spin and isrbxactive() then
				mousemoverel(100,0);
			end
		end;
	end;
	connection = game:GetService('RunService').RenderStepped:Connect(function()
		if removeaimbot then
			connection:Disconnect()
		else
			if (type(folder) == 'table' and #folder > 0) or (type(folder == 'userdata') and #folder:GetChildren() > 0) then
				pcall(Aim)
			end;
		end;
	end);

	local Self = { }

	function Self:Toggle(v1)
		if v1 ~= nil then
			if v1 == true or v1 == 'true' or v1 == 'on' then
				doaimbot = true
			elseif v1 == false or v1 == 'false' or v1 == 'off' then
				doaimbot = false
			end;
		else
			doaimbot = not doaimbot
		end;
	end;
	function Self:Remove()
		removeaimbot = true;
	end;
	function Self:ChangeFolder(v1)
		folder = v1;
	end;
	function Self:ChangeVisible(v1)
		visible = v1;
	end;
	function Self:ChangeTeam(v1)
		team = v1 or not team;
	end;
	function Self:ChangeDistance(v1)
		distance = tonumber(v1) or 9e9;
	end;
	function Self:ChangeKey(v1)
		key = v1;
	end;
	function Self:ChangeSmoothness(v1)
		smoothness = tonumber(v1) or 1;
	end;
	function Self:ChangeTarget(v1)
		target = v1;
	end;
	function Self:ChangeSpin(v1)
		spin = v1;
	end;
	function Self:IsToggled()
		if not removeaimbot then
			return doaimbot
		end;
		return false
	end;

    return Self
end;

function Aimbot:Aim(v1)
	for i = 0, 10 do
		local v, isonscreen = game.Workspace.CurrentCamera:WorldToViewportPoint(v1.Position)
		local mouse = game:GetService('UserInputService'):GetMouseLocation()
		print(v, isonscreen)
		if isonscreen then
			mousemoverel(v.X - mouse.X, v.Y - mouse.Y)
		end;
		game:GetService('RunService').RenderStepped:wait()
	end;
end;

-- // Message System // --
local Message = main_module.Message

Message.gui = Instance.new('ScreenGui', main_module.MainFrame)
Message.gui.Name = 'Messages'

function Message.new(settings)
	local type = settings['type'] or 'Notification'
	local title = settings['title'] or 'Notification'
	local msg = settings['msg'] or '[EMPTY]'
	local time = settings['time'] or 1

	local frame = Instance.new('Frame', Message.gui)
	frame.BackgroundColor3 = Color3.fromRGB(115, 80, 146)
	frame.BorderSizePixel = 0
	frame.Position = UDim2.new(1, 0, 0.85, 0)
	frame.Size = UDim2.new(0.2, 0, 0.1, 0)

	local label = Instance.new('TextLabel', frame)
	label.BackgroundTransparency = 1
	label.Size = UDim2.new(1, 0, 0.3, 0)
	label.TextSize = 30
	label.TextColor3 = Color3.fromRGB(140, 140, 140)
	label.Font = 'SourceSansBold'
	label.Text = title

	local content = Instance.new('TextLabel', frame)
	content.BackgroundTransparency = 1
	content.Size = UDim2.new(1, 0, 0.7, 0)
	content.Position = UDim2.new(0, 0, 0.3, 0)
	content.TextSize = 20
	content.TextColor3 = Color3.fromRGB(255,255,255)
	content.Font = 'SourceSansItalic'
	content.Text = msg

	local _tweenInfo = TweenInfo.new(3,Enum.EasingStyle.Quad,Enum.EasingDirection.Out,0,false,0)

	game:GetService('TweenService'):Create(frame, _tweenInfo, {Position=UDim2.new(0.75, 0, 0.85, 0)}):Play()
	wait(time+3)
	game:GetService('TweenService'):Create(frame, _tweenInfo, {Position=UDim2.new(1, 0, 0.85, 0)}):Play()
	wait(3)
	frame:Destroy()

end

-- // Keybinds // --
local Keybind = main_module.Keybind
Keybind.binds = { }

function Keybind:NewBind(_key, _func)
	uis.InputBegan:connect(function(key)
		if key.KeyCode == _key then
			_func();
		end
	end)
	Keybind.binds[_key] = _func;
end

-- // Admin Commands // --
local Admin = main_module.Admin
Admin.commands = { }

function Admin:Create(prefix)
    plr.Chatted:Connect(function(message)
        local msg = message:lower()
        local sep = msg:split(' ')
        local first = sep[1]:sub(2)

        if msg:sub(1,1) == prefix then
            if rawget(Admin.commands, first) then
                rawget(Admin.commands, first)(table.concat(sep, ' ', 2))
            end;
        end;
    end);

    Self = { }

    function Self.newCommand(cmd, _function)
        Admin.commands[cmd] = _function
    end;

    return Self
end;
return getgenv().main_module;