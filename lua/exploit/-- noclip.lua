-- Sinsanes noclip script

local _settings = {
	debounce = .1;
	size = Vector3.new(5,5,5);
	offset = Vector3.new(0,1.6,0);
	transparency = 1;
}

local uis = game:GetService('UserInputService')
local _plr = game.Players.LocalPlayer
local _char = _plr.Character or _plr.CharacterAdded:Wait()
local _hrp = _char:WaitForChild('HumanoidRootPart')

getgenv().TOGGLE = true;

function attatch()
	local _part = Instance.new('Part', _char)
	_part.Anchored = true
	_part.CanCollide = false
	_part.Size = _settings.size
	_part.Transparency = _settings.transparency
	_part.CFrame = _hrp.CFrame
	
	local _recent = { }
	spawn(function()
		game:GetService('RunService'):BindToRenderStep('On', Enum.RenderPriority.Camera.Value, function()

			if TOGGLE then

				_part.CFrame = _hrp.CFrame + _settings.offset
				local _parts = game.Workspace:GetPartsInPart(_part)

				for i,v in pairs(_parts) do
					if _recent[v] or (not v:IsDescendantOf(_char) and v.CanCollide == true) then
						_recent[v] = tick()
						v.CanCollide = false
					end
				end

			end
		end)
	end)
	spawn(function()
		game:GetService('RunService'):BindToRenderStep('Off', Enum.RenderPriority.Camera.Value, function()
			for i,v in pairs(_recent) do
				if tick() - v >= _settings.debounce then
					i.CanCollide = true
				end
			end
		end)
	end)
    spawn(function()
        repeat wait() until not _char or not _char:FindFirstChild('Humanoid') or _char.Humanoid.Health <= 0
        game:GetService('RunService'):UnbindFromRenderStep('On')
        game:GetService('RunService'):UnbindFromRenderStep('Off')
    end)
end

uis.InputBegan:Connect(function(key)
    if key.KeyCode == Enum.KeyCode.N then
		getgenv().TOGGLE = not getgenv().TOGGLE
	end
end)

_plr.CharacterAdded:connect(function(c)
	_char = c
	_hrp = c:WaitForChild('HumanoidRootPart')
	attatch()
end)

attatch()

warn('Noclip Executed')