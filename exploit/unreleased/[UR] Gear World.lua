-- game https://www.roblox.com/games/1407487264/GearLand-2-1

local main_module = loadstring(game:HttpGet('https://raw.githubusercontent.com/Sinscrips/source_scripts/main/main_module_v2.lua', true))()
local library = main_module['Library']
local esp = main_module['Esp']
local aimbot = main_module['Aimbot']
local message = main_module['Message']
local uis = game:GetService('UserInputService')
local cls = game:GetService('CollectionService')

local _plr = game.Players.LocalPlayer

local _client = { 
}
local _shared = { 
    EspFolder = { };
    AimFolder = { };

}
local _settings = {
    gun_mods = {
        Mode = 'Default';
        Spread = false;
        Delay = false;
    };
}

-- // Functions // --
function _shared:ClearFolders()
    for i,v in pairs(self.AimFolder) do
        table.remove(self.AimFolder, i)
    end
    for i,v in pairs(self.EspFolder) do
        self.EspFolder[i] = nil
    end
    --print('folders cleared')
end
function _shared:UpdatedFolders()
    _shared:ClearFolders()
    for i,v in pairs(game.Workspace.AI:GetChildren()) do
        print(v, v.Head, v.HumanoidRootPart)
        _shared.EspFolder[v] = v
        table.insert(_shared.AimFolder, v)
        --print('enemy player ' .. v.Name .. ' inserted')
    end
    --warn('folders updated')
end

-- // GUI Frame 1 // --
local Frame1 = library:AddFrame({name='Gun Hax'})

Frame1:AddToggle('Disable Spread', function(v1)
    _settings.gun_mods.Spread = v1
end)
Frame1:AddToggle('Disable Fire Delay', function(v1)
    _settings.gun_mods.Delay = v1
end)
Frame1:AddSwitch('Fire Mode', {'Default', 'Auto', 'Semi', 'Shotgun'}, function(v1)
    _settings.gun_mods.Mode = v1
end)

-- // GUI Frame 2 // --
local Frame2 = library:AddFrame{name='Plr Hax'}

local _esp
Frame2:AddToggle('Esp', function(v1)
    if v1 then
        _esp = esp.new({folder=_shared.EspFolder,color=Color3.fromRGB(255,0,0)})
        _shared:UpdatedFolders()
    else
        _esp:Remove()
    end
end)

local _aimbot
Frame2:AddToggle('Aimbot', function(v1)
    if v1 then
        _aimbot = aimbot.new({folder=_shared.AimFolder,smoothness=1.5})
        _shared:UpdatedFolders()
    else
        _aimbot:Remove()
    end
end)



-- // Metatables // --
m = getrawmetatable(game)
old_Index = m.__index
oldnc = m.__namecall
oldnw = m.__newindex
oldc = m.__call

setreadonly(m, false)

local plr = game.Players.LocalPlayer

m.__namecall = function(self, ...)
    local args = {...}
    if getnamecallmethod() == 'InvokeServer' and tostring(self) == 'TakeDamage' then
        if args[1] == 'Get' then
            local _old = oldnc(self, unpack(args))
            
            local weaponInfo = function(v1)
                for i,v in pairs(_old) do
                    if v[1] == v1 then
                        print(v1, v2)
                        return v[2]
                    end
                end
            end

            return {
                {'Accurate',_settings.gun_mods['Spread'] and 0 or weaponInfo('Accurate')};
                {'AutoFire',_settings.gun_mods['Mode']=='Auto' and true or _settings.gun_mods['Mode']=='Semi' and false or weaponInfo('AutoFire')};
                {'FireRate',_settings.gun_mods['Delay'] and 0.01 or weaponInfo('FireRate')};
                {'BulletCount', _settings.gun_mods['Mode']=='Shotgun' and 100 or weaponInfo('BulletCount')};
                --{'Damage',math.huge}; -- FX only
            }
        end
    end
    
    return oldnc(self, unpack(args))
end

-- // AI Spy // --
game.Workspace.AI.ChildAdded:connect(function(c)
    if c:WaitForChild('Humanoid') then
        _shared:UpdatedFolders()
    end
end)